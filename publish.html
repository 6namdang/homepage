<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoang's Writer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles to match the "Blank.page" feel */
        .zen-editor:focus { outline: none; }
        .cake-line { min-height: 1.5em; }
        /* Hide scrollbar for a cleaner look */
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-[#ffffff] text-[#1a1a1a] antialiased selection:bg-blue-100">

    <nav class="fixed top-0 w-full flex items-center justify-between px-6 py-4 z-50">
        <div class="flex gap-4">
            <button onclick="publishToGithub()" id="publishBtn" class="text-sm font-medium text-gray-400 hover:text-black transition-colors">
                Publish
            </button>
        </div>
        <div class="flex gap-6 items-center">
            <span id="status" class="text-xs text-gray-300 italic"></span>
            <div class="h-2 w-2 rounded-full bg-green-400 opacity-50"></div>
        </div>
    </nav>

    <main class="flex justify-center pt-32 px-6">
        <div class="w-full max-w-[700px]">
            <input type="text" id="postTitle" 
                class="w-full text-4xl font-serif border-none focus:ring-0 placeholder-gray-200 mb-8 outline-none" 
                placeholder="Untitled Post">
            
            <div id="editor" contenteditable="true" 
                class="zen-editor w-full text-lg md:text-xl font-serif leading-relaxed min-h-[60vh] text-gray-800"
                data-placeholder="Start writing..."></div>
        </div>
    </main>

    <script>
        const GITHUB_TOKEN = "YOUR_GITHUB_TOKEN"; // Keep this secret!
        const OWNER = "6namdang";
        const REPO = "your-repo-name";

        async function publishToGithub() {
            const title = document.getElementById('postTitle').value || "Untitled";
            const content = document.getElementById('editor').innerText;
            const status = document.getElementById('status');

            if (!content) return alert("Write something first!");

            const fileName = `posts/${title.toLowerCase().replace(/ /g, "-")}.md`;
            const markdown = `---\ntitle: "${title}"\ndate: "${new Date().toISOString()}"\n---\n\n${content}`;
            
            // Base64 encoding for GitHub API
            const encodedContent = btoa(unescape(encodeURIComponent(markdown)));

            status.innerText = "Syncing...";

            try {
                const response = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${fileName}`, {
                    method: "PUT",
                    headers: {
                        "Authorization": `Bearer ${GITHUB_TOKEN}`,
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        message: `Blog: ${title}`,
                        content: encodedContent
                    })
                });

                if (response.ok) {
                    status.innerText = "Saved to GitHub";
                    setTimeout(() => status.innerText = "", 3000);
                } else {
                    status.innerText = "Error saving";
                }
            } catch (e) {
                status.innerText = "Connection lost";
            }
        }
    </script>
</body>
</html>